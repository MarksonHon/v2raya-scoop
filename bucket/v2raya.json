{
    "version": "1.5.9.1698.1",
    "description": "v2rayA(stable version). A web GUI client of Project V which supports V2Ray, Xray, SS, SSR, Trojan and Pingtunnel.",
    "homepage": "https://github.com/v2rayA/v2raya",
    "license": {
        "identifier": "AGPL-3.0-only",
        "url": "https://github.com/v2rayA/v2rayA/raw/master/LICENSE"
    },
    "depends": "v2ray",
    "suggest": {
        "v2ray-rules-dat": "v2raya/v2ray-rules-dat"
    },
    "notes": "Start v2rayA with Windows by running: 'reg import \"$dir\\add-startup.reg\"'.",
    "architecture": {
        "64bit": {
            "url": "https://github.com/v2rayA/v2rayA/releases/download/v1.5.9.1698.1/v2raya_windows_x64_1.5.9.1698.1.exe#/v2rayaWin.exe",
            "hash": "5e764e82723e55d9a3446769a7a07427404a28d51e952a693a503caff8d422e0",
            "pre_install": [
                "if (Test-Path \"$env:UserProfile\\.config\\v2raya\") {",
                "    info '[Persistent data]: Copying user data...'",
                "    ensure \"$persist_dir\" | Out-Null",
                "    Copy-Item \"$env:UserProfile\\.config\\v2raya\\*\" \"$persist_dir\\\" -ErrorAction SilentlyContinue -Recurse -Force",
                "    Remove-Item \"$env:UserProfile\\.config\\v2raya\" -ErrorAction SilentlyContinue -Recurse -Force",
                "}",
                "ensure \"$persist_dir\" | Out-Null",
                "New-Item \"$env:UserProfile\\.config\\v2raya\" -ItemType Junction -Target \"$persist_dir\" | Out-Null",
                "Set-Content \"$dir\\start-v2raya.ps1\" -Value 'Start-Process -FilePath \"$(scoop prefix v2raya)\\v2rayaWin.exe\" -ArgumentList @(\"--lite\", \"--log-disable-timestamp\", \"--log-file v2raya.log\") -WorkingDirectory \"$env:TEMP\" -WindowStyle Hidden' -Encoding Ascii",
                "Set-Content \"$dir\\stop-v2raya.ps1\" -Value 'taskkill.exe /F /IM v2rayawin.exe /FI \"status eq running\" | Out-Null' -Encoding Ascii"
            ],
            "post_install": [
                "$exepath = \"powershell -NoLogo -NoProfile -ExecutionPolicy -File $bucketsdir\\meta\\scripts\\clashn\\start-clashn.ps1\".Replace('\\', '\\\\')",
                "'add-startup', 'remove-startup' | ForEach-Object {",
                "    $content = Get-Content \"$bucketsdir\\tian\\scripts\\v2raya\\$_.reg\"",
                "    $content = $content.Replace('$exepath', $exepath)",
                "    if ($global) {",
                "       $content = $content.Replace('HKEY_CURRENT_USER', 'HKEY_LOCAL_MACHINE')",
                "    }",
                "    $content | Set-Content -Path \"$dir\\$_.reg\"",
                "}"
            ],
            "pre_uninstall": [
                "stop-v2raya",
                "Remove-Item \"$env:UserProfile\\.config\\v2raya\" -ErrorAction 'SilentlyContinue' -Force -Recurse"
            ],
            "uninstaller": {
                "script": "if ($cmd -eq 'uninstall') { reg import \"$dir\\remove-startup.reg\" }"
            }
        }
    },
    "bin": [
        [
            "v2rayaWin.exe",
            "v2raya",
            "--lite"
        ],
        [
            "v2rayaWin.exe",
            "v2rayaWin"
        ],
        "start-v2raya.ps1",
        "stop-v2raya.ps1"
    ],
    "env_set": {
        "V2RAYA_V2RAY_BIN": "$(scoop prefix v2ray)\\v2ray.exe"
    },
    "checkver": {
        "url": "https://api.github.com/repos/v2rayA/v2raya/releases/latest",
        "regex": "v2raya_windows_x64_([\\d.]+).exe"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/v2rayA/v2rayA/releases/download/v$version/v2raya_windows_x64_$version.exe#/v2rayaWin.exe"
            }
        }
    }
}
